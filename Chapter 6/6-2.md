# 6.2 널 객체 패턴을 적절히 사용하라

## 6.2.1 빈 컬렉션을 반환하면 코드가 개선될 수 있다

```java

Set<String>? getClassNames(HtmlElement element) {
    String? attribute = element.getAttribute("class");

    if (attribute == null) {
        return null;
    }
    return new Set(attribute.split(" "));
}

boolean isElementHighlighted(HtmlElement element) {
    Set<String>? classNames = getClassNames(element);

    if (classNames == null) {
        return false;
    }

    return classNames.contains("highlighted");
}

```

- 위 경우 class 속성이 지정되지 않으면 null 반환하고, class 속성이 지정되어있으나 비어있는 경우에는 빈 집합이 반환되는 게 별로 의미가 없다.
- 이를 널 객체 패턴을 사용해서 코드를 개선

```java
Set<String>? getClassNames(HtmlElement element) {
    String? attribute = element.getAttribute("class");

    if (attribute == null) {
        return new Set();
    }
    return new Set(attribute.split(" "));
}

boolean isElementHighlighted(HtmlElement element) {
    return getClassNames(element).contains("highlighted");
}


```

- 쓸데없는 널 체킹이 사라짐

## 6.2.2 빈 문자열을 반환하는 것도 때로는 문제가 될 수 있다

- 문자열을 단순히 문자들의 모음으로만 사용하면 문제가 없을 수 있다.
- 만약 문자열이 ID로 쓰인다면, 문제가 발생한다

```java

class Payment {
    private final String? cardTransactionId;

    String getCardTransactionId() {
        if (cardTransactionId == null) {
            return "";
        }

        return cardTransactionId;
    }
}

```
- 만약 위와 같다면 해당 필드가 항상 널이 되지 않는 것으로 생각하고, 카드 트랜잭션이라고 생각할 수 있게 됨
- 이런 경우는 null을 반환하는게 더 맞음

## 6.2.3 더 복잡한 널 객체는 예측을 벗어날 수 있다

- 핸드폰을 사는데, 밀봉된 박스를 주고 집가서 까보니까 비어있었다 -> 널 객체를 잘못 쓰는 전형적인 패턴

```java

class CoffeeMug {
    CoffeeMug(Double diameter, Double height) {}
}

class CoffeeMugInventory {
    CoffeeMug getRandomMug() {
        if (mugs.isEmpty()) {
            return new CoffeeMug(0.0, 0.0);
        }
        return ...;
    }
}

```
- 위 경우 크기가 0인 커피 머그잔이라는 계약이 없는 경우 오류를 초래할 수 있다.
- 이 경우는 널 반환이 더 낫다.


## 6.2.4 널 객체 구현은 예상을 벗어나는 동작을 유발할 수 있다

```java

interface CoffeeMug {
    double getDiameter();
    double getHeight();
    void reportMugBroken();
}

class NullCoffeeMug implements CoffeeMug {
    double getDiameter() {return 0.0;}
    double getHeight() {return 0.0;}
    void reportMugBroken() {}
}

```

- 받는 쪽에서 NullCoffeeMug 인스턴스인지 확인함으로써 널 객체를 가졌는지 확인해야함 -> null 리턴하고 체킹하는거랑 무슨 차이?
- 널 안전성 (? 연산자) 나 옵셔널을 사용하거나, 아니면 null을 반환하는게 나은 경우가 있다는 사실을 기억해야함