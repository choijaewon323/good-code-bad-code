# 6.1 매직값을 반환하지 말아야 한다

- 매직값 : 값이 없거나 오류가 발생했을 때 -1 반환하는거

## 6.1.1 매직값은 버그를 유발할 수 있다

- getAge() 함수는 널이 아닌 정수를 반환하므로 반환값은 항상 사용 가능하다고 가정하게 됨

```java

class User {
    int getAge() {
        if (age == null) {
            return -1;
        }
        return age;
    }
}

Double getMeanAge(List<User> users) {
    if (users.isEmpty()) {
        return null;
    }

    double sumOfAges = 0.0;
    for (User user in users) {
        sumOfAges += user.getAge().toDouble();
    }
    return sumOfAges / users.size().toDouble();
}

```
- 이 경우 잘못된 값이 리턴되며, 오류는 발생하지 않게 됨
- -1을 리턴한다는 사실을 모르고 있다면, 테스트 코드에도 이를 반영하지 않아 테스트로도 잡지 못할 수 있음


## 6.1.2 해결책: 널, 옵셔널 또는 오류를 반환하라

- 매직값을 반환한다는 사실까지 알아야 하는 함수의 세부 사항을 알야아 하는 문제가 발생
- 널 안전성 (? 연산자)를 지웒나는 경우는 널이 가능하도록, 없다면 옵셔널을 리턴하도록 하는게 좋다

```java

class User {
    private final Int? age;

    Int? getAge() {
        return age;
    }
}

```

- 이렇게 바꾸면 값이 없는 경우는 NPE가 발생하므로 이를 처리하도록 코드를 수정하게 된다.

## 6.1.3 때때로 매직값이 우연히 발생할 수 있다
- 의도적이지 않은 경우도 있다.
```java
int minValue(List<Integer> values) {
    int minValue = Integer.MAX_VALUE;
    for (int value : values) {
        minValue = Math.min(value, minValue);
    }
    return minValue;
}
```
- 이 경우 리스트가 비어있으면 MAX_VALUE를 리턴하게됨
- 만약 리스트가 비어있을 때는 널값이나 빈 옵서녈을 반환, 혹은 오류 전달을 하는게 더 낫다.