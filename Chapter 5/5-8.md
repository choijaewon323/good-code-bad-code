# 5.8 익명 함수를 적절하게 사용하라

## 5.8.1 익명 함수는 간단한 로직에 좋다

```java
List<Feedback> getUsefulFeedback(List<Feedback> allFeedback) {
    return allFeedback
    .filter(feedback -> !feedback.getComment().isEmpty());
}
```

- 이해하기 쉽고, 가독성에도 문제가 없다
- 만약 명명 함수라면?
```java

List<Feedback> getUsefulFeedback(List<Feedback> allFeedback) {
    return allFeedback
    .filter(this::hasNonEmptyComment);
}

private boolean hasNonEmptyComment(Feedback feedback) {
    return !feedback.getComment().isEmpty();
}

```

- 만약에 저 로직이 중요하다면 명명 함수로 뺴는게 나을 수도 있으나, 한번만 쓰인다면 굳이 싶긴 하다.

## 5.8.2 익명 함수는 가독성이 떨어질 수 있다

```java
List<Short> getValidIds(List<Short> ids) {
    return ids
    .filter(id -> id != 0)
    .filter(id -> countSetBits(id & 0x7FFF) % 2 == ((id & 0x8000) >> 15));
}
```

- 익명 함수의 내용이 자명하지 않은 수준 (너무 복잡)이여서 가독성이 떨어짐
- 패리티 비트를 확인한다는 점이 잘 보이지 않음

## 5.8.3 해결책: 대신 명명 함수를 사용하라

```java
List<Short> getValidIds(List<Short> ids) {
    return ids
    .filter(id -> id != 0)
    .filter(this::isParityBitCorrect);
}

private boolean isParityBitCorrect(short id) {}
```

- 이름을 더하니까 더 가독성 좋음
- 익명은 자명한 경우에만 사용 -> id != 0 의 경우는 굳이 명명 함수로 뽑지 않음

## 5.8.4 익명 함수가 길면 문제가 될 수 있다
```java

List<ListItem> buildFeedbackListItems(
    List<Feedback> allFeedback
) {
    return allFeedback.map(feedback -> 
    new ListItem(
        title: new TextBox(
            text: feedback.getTitle(),
            options: new TextOptions(weight: TextWeight.BOLD),
        ),
        body: new Column(
            children: [
                new TextBox(
                    text: feedback.getComment(),
                    border: new Border(style: BorderStyle.DASHED),
                ),
                new Row(
                    children: feedback.getCategories().map(category -> 
                    new TextBox(
                        text: category.getLabel(),
                        options: new TextOptions(style: TextStyle.ITALIC),
                    ))
                )
            ]
        )
    ))
}

```

- 위 코드는 익명 함수 외에도 문제가 많다.
- 익명 함수 안에 또 익명 함수가 있어서 복잡해짐

## 5.8.5 해결책: 긴 익명 함수를 여러 개의 명명 함수로 나누라

```java
ListItem buildFeedbackItem(Feedback feedback) {
    return new ListItem(
        title: buildTitle(feedback.getTitle()),
        body: new Column(
            children: [
                buildCommentText(feedback.getComment()),
                buildCategories(feedback.getCategories())
            ]
        )
    )
}

...

private Row buildCategories(List<Category> categories) {
    return new Row(
        children: categories.map(this::buildCategory)
    );
}

private TextBox buildCategory(Category category) {
    return new TextBox(
        text: category.getLabel(),
        options: new TextOptions(style: TextStyle.ITALIC)
    );
}

```

- 한꺼번에 너무 많은 일을 하는 큰 함수를 분리하여 코드 가독성을 높임